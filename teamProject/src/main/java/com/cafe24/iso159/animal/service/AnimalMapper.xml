<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cafe24.iso159.animal.service.AnimalMapper">
	<!--동물리스트 띄우는 맵퍼  -->
	<resultMap id="selectAnimalListMap" type="com.cafe24.iso159.animal.service.AnimalCommand">
		<id column="os_name" property="osName"/>
		<result column="osNameAnimalKind" property="osNameAnimalKind"/>
		<result column="animal_breed" property="animalBreed"/>
		<result column="animal_area" property="animalArea"/>
		<result column="animal_id_code" property="animalIdCode"/>
		<result column="animal_weight" property="animalWeight"/>
		<result column="animal_age" property="animalAge"/>
		<result column="bl_shelter_name" property="blShelterName"/>
		<result column="animal_enroll_date" property="animalEnrollDate"/>
	</resultMap>
	
	<!-- 동물등록 -->
	<insert id="insertAnimal" parameterType="com.cafe24.iso159.animal.service.Animal">
		INSERT INTO 
			t_animal 
			(
				animal_code, 
				os_code_animal, 
				bl_code, 
				m_shelter_id, 
				os_code_kind, 
				animal_breed, 
				animal_area, 
				animal_id_code, 
				animal_weight, 
				animal_age, 
				animal_enroll_date) 
			VALUES 
			(
				#{animalCode}, 
				#{osCodeAnimal}, 
				#{blCode},
				#{mShelterId}, 
				#{osCodeKind}, 
				#{animalBreed}, 
				#{animalArea}, 
				#{animalIdCode}, 
				#{animalWeight}, 
				#{animalAge},
				now()
			);
	</insert>
	
	<!-- 동물 리스트 전체조회-->
	<select id="selectAnimalList" resultMap="selectAnimalListMap">
		SELECT
			os.os_name
			,osk.os_name as osNameAnimalKind			
			, animal_breed
			, animal_area
			, animal_id_code
			, animal_weight 
			, animal_age
            , bl.bl_shelter_Name
			, animal_enroll_date 
		FROM t_animal a
		INNER JOIN t_overall_status os
		ON os.os_code = a.os_code_animal
        INNER JOIN t_overall_status osk
		ON osk.os_code = a.os_code_kind
        INNER JOIN t_business_license bl
		ON a.bl_code = bl.bl_code
	</select>	
</mapper>